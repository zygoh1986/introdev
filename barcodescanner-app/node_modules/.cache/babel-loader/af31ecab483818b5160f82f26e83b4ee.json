{"ast":null,"code":"//import {APIKEY, URL_PATH, URL_EXTENSION} from '../../assets/config'\nimport React from 'react';\nimport { db, auth } from \"../../assets/firebase\";\n\nclass scanedItem extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data: null\n    };\n  }\n\n  componentDidMount() {\n    console.log('mounted');\n    db.collection('data').get().then(snapshot => {\n      console.log(snapshot);\n    }).catch(error => console.log(error));\n  }\n\n}\n\nexport const startScanning = () => {\n  return {\n    type: \"START_SCANNING\"\n  };\n};\nexport const clearScanned = () => {\n  return {\n    type: 'CLEAR_SCANNED'\n  };\n};\nexport const setItem = i => {\n  return {\n    type: 'SET_ITEM',\n    payload: i\n  };\n};\nexport const deleteItem = i => {\n  return {\n    type: 'DELETE_ITEM',\n    payload: i\n  };\n};\nexport const processBarcode = barcode => {\n  return dispatch => {\n    dispatch(spinnerOn());\n    let url = URL_PATH + barcode + URL_EXTENSION + APIKEY;\n    let req = new Request(url, {\n      headers: {\n        'Access-Control-Allow-Origin': 'http://localhost:3000'\n      },\n      mode: 'no-cors'\n    });\n    let product = null;\n    fetch(req).catch(err => console.log('error', err)).then(res => {\n      console.log(res.status);\n\n      if (res.status !== 200) {\n        return {\n          resStatus: res.status\n        };\n      } else if (res.status === 200) {\n        return res.json();\n      }\n    }).then(parsedRes => {\n      if (parsedRes.resStatus !== 200) {\n        parsedRes.resStatus === 0 ? dispatch(invalidBarcode('noAPI')) : dispatch(invalidBarcode('invalid'));\n      } else {\n        product = {\n          barcode_number: parsedRes.products[0].barcode_number,\n          barcode_type: parsedRes.products[0].barcode_type,\n          product_name: parsedRes.products[0].product_name,\n          product_image: parsedRes.products[0].images[0],\n          manufacturer: parsedRes.products[0].manufacturer,\n          brand: parsedRes.products[0].brand,\n          category: parsedRes.products[0].category,\n          description: parsedRes.products[0].description\n        };\n        dispatch(productDetected(product));\n      }\n    });\n  };\n};\nexport const spinnerOn = () => {\n  return {\n    type: 'SPINNER_ON'\n  };\n};\nexport const productDetected = product => {\n  return {\n    type: 'PRODUCT_DETECTED',\n    payload: product\n  };\n};\nexport const invalidBarcode = err => {\n  let errText = err === 'noAPI' ? 'NO_API_KEY' : 'INVALID_BARCODE';\n  return {\n    type: errText\n  };\n};","map":{"version":3,"sources":["/Users/zhangyu/Documents/barcodescanner-app/barcodescanner-app/barcodescanner/src/store/actions/scannedItems.js"],"names":["React","db","auth","scanedItem","Component","state","data","componentDidMount","console","log","collection","get","then","snapshot","catch","error","startScanning","type","clearScanned","setItem","i","payload","deleteItem","processBarcode","barcode","dispatch","spinnerOn","url","URL_PATH","URL_EXTENSION","APIKEY","req","Request","headers","mode","product","fetch","err","res","status","resStatus","json","parsedRes","invalidBarcode","barcode_number","products","barcode_type","product_name","product_image","images","manufacturer","brand","category","description","productDetected","errText"],"mappings":"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","sourcesContent":["//import {APIKEY, URL_PATH, URL_EXTENSION} from '../../assets/config'\nimport React from 'react' \nimport { db, auth } from \"../../assets/firebase\";\n\nclass scanedItem extends React.Component {\n  state = {\n    data: null\n  }\n\ncomponentDidMount() {\n  console.log('mounted')\n  db.collection('data')\n    .get ()\n    .then ( snapshot => {\n        console.log(snapshot)\n    })\n    .catch (error => console.log(error))\n}\n}\n\n\n\nexport const startScanning = () => {\n  return {\n    type: \"START_SCANNING\"\n  }\n}\n\nexport const clearScanned = () => {\n  return {\n    type: 'CLEAR_SCANNED'\n  }\n}\n\nexport const setItem = (i) => {\n  return {\n    type: 'SET_ITEM',\n    payload: i\n  }\n}\n\nexport const deleteItem = (i) => {\n  return {\n    type: 'DELETE_ITEM',\n    payload: i\n  }\n}\n\nexport const processBarcode = (barcode) => {\n  return dispatch => {\n    dispatch(spinnerOn())\n    \n    let url = URL_PATH + barcode + URL_EXTENSION + APIKEY\n    \n    let req = new Request(url , {\n      headers: {\n        'Access-Control-Allow-Origin': 'http://localhost:3000'\n      },\n      mode: 'no-cors'\n    })\n    \n    let product = null\n    fetch(req)\n    .catch(err => console.log('error', err))\n    .then(res => {\n      console.log(res.status)\n      if(res.status !== 200){\n        return {\n          resStatus: res.status\n        }\n      } else if(res.status === 200) {\n        return res.json()\n      }\n    })\n    .then(parsedRes => {\n      if(parsedRes.resStatus !== 200){\n        parsedRes.resStatus === 0 ? dispatch(invalidBarcode('noAPI')) : dispatch(invalidBarcode('invalid'))\n      } else {\n        product = {\n          barcode_number: parsedRes.products[0].barcode_number,\n          barcode_type: parsedRes.products[0].barcode_type,\n          product_name: parsedRes.products[0].product_name,\n          product_image: parsedRes.products[0].images[0],\n          manufacturer: parsedRes.products[0].manufacturer,\n          brand: parsedRes.products[0].brand,\n          category: parsedRes.products[0].category,\n          description: parsedRes.products[0].description,\n        }\n        dispatch(productDetected(product))\n      } \n    })\n  }\n  }\n\nexport const spinnerOn = () => {\n  return {\n    type: 'SPINNER_ON'\n  }\n}\n  \n  \nexport const productDetected = (product) => {\n  return {\n    type: 'PRODUCT_DETECTED',\n    payload: product\n  }\n}\n\nexport const invalidBarcode = (err) => {\n  let errText = err === 'noAPI' ? 'NO_API_KEY' : 'INVALID_BARCODE'\n  return {\n    type: errText,\n  }\n}\n\n\n"]},"metadata":{},"sourceType":"module"}